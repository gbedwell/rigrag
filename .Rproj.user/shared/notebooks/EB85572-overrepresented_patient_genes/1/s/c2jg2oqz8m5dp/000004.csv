"0","acute.rigs.overlap <- acute.int.counts %>%"
"0","  dplyr::full_join(., rigs.int.counts, by=""gene.name"") %>%"
"0","  tidyr::drop_na() %>%"
"0","  dplyr::mutate(fold.change = avg.frac.x/avg.frac.y,"
"0","                z.score = (avg.frac.x-avg.frac.y)/sd.frac.y,"
"0","                p.from.z = pnorm(z.score, lower.tail=FALSE, log.p = FALSE),"
"0","                q.value = p.adjust(p.from.z, method = ""BH"", n = length(p.from.z))) %>%"
"0","  dplyr::select(gene.name,  fold.change, z.score, p.from.z, q.value,"
"0","                avg.frac.x, sd.frac.x, gene.length.x, cso.x) %>%"
"0","  dplyr::arrange(gene.name) %>%"
"0","  dplyr::mutate(index = row_number())"
"0","colnames(acute.rigs.overlap) <- c(""gene.name"",""fold.change"",""z.score"",""p.from.z"",""q.value"","
"0","                                    ""avg.frac"",""sd.frac"",""gene.length"",""cso"", ""index"")"
"0","acute.rigs.overlap.filter <- acute.rigs.overlap %>%"
"0","  dplyr::filter(z.score >= 10)"
"0","acute.rigs.overlap.plot <- ggplot(acute.rigs.overlap, aes(x=index, y=-log10(q.value), fill=as.character(cso))) +"
"0","  geom_point(size=3, shape=21) +"
"0","  geom_label_repel(data=acute.rigs.overlap.filter, aes(label=gene.name), "
"0","                   box.padding = 1, force=1, alpha=1, segment.alpha=1,"
"0","                   nudge_x = 0, nudge_y = 0.005) +  "
"0","  scale_fill_brewer(palette = ""Blues"") +"
"0","  theme_bw() + theme(axis.text=element_text(size=14),"
"0","                     axis.title=element_text(size=16), "
"0","                     legend.position = ""none"", strip.text.y = element_text(size = 12),"
"0","                     plot.title = element_text(size=12, face=""bold"")) +"
"0","  scale_x_continuous(limits=c(0,1300),"
"0","                     breaks=c(0,200,400,600,800,1000,1200)) +"
"0","  scale_y_continuous(limits=c(-50,200),"
"0","                     breaks=c(-50,0,50,100,150,200)) +"
"0","  labs(x = ""Gene Index (Alphabetical Order)"", title=""Acute RIG-matched Genes"") +"
"0","  ylab(expression(-log[10](""q-value"")))"
"0","acute.rigs.overlap.plot"
